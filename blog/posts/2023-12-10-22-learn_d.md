---
layout: Post
title: django
subtitle: django
author: emo
date: 2023-10-22
useHeaderImage: true
headerImage: /img/home-bg/29.jpg
headerMask: rgba(40, 57, 101, .4)
giscus: false
catalog: true
hide: false
tags:
  - django
---

## 理解Django的基本原理和结构
### 项目组织结构
```s
myproject/
├── manage.py  # Django项目的命令行工具，可以用来执行各种项目管理任务，比如启动开发服务器、创建数据库表、运行测试等。
├── myproject/
│   ├── __init__.py  # 空文件，告诉Python这个目录应该被视为一个Python包。
│   ├── settings.py  # 配置文件，包含了项目的所有设置，比如数据库配置、DEBUG模式、INSTALLED_APPS、MIDDLEWARE等。
│   ├── urls.py  # URL配置文件，定义了URL和视图函数的对应关系。在大型项目中，通常会把URL配置分散到各个应用中，然后在这个文件中包含各个应用的URL配置。
│   ├── asgi.py  # ASGI配置文件，用于异步服务器网关接口，支持Websocket等协议
│   └── wsgi.py  # WSGI配置文件，用于Web服务器网关接口，用于部署项目
├── app1/  # 应用目录。一个Django项目通常会包含多个应用，每个应用都是一个Python包，包含了一组相关的模型、视图、模板、静态文件等。
│   ├── __init__.py
│   ├── models.py  # 应用的数据模型，即数据库的表结构。
│   ├── views.py  # 应用的视图函数，即处理HTTP请求的函数。
│   ├── urls.py  # 应用的URL配置，即URL和视图函数的对应关系。
│   ├── admin.py  # 应用的后台管理界面。
│   ├── tests.py  # 应用的测试代码。
│   └── migrations/  # 应用的数据库迁移文件。
├── app2/
├── app3/
├── templates/  # 模板文件，即HTML文件。在大型项目中，通常会把模板文件分散到各个应用中。
├── static/  # 静态文件，比如CSS文件、JavaScript文件、图片等。
└── requirements.txt  # Python依赖包，可以用pip工具来安装这些依赖包。
```

### Django的基本原理 
Django是一个基于Python的开源Web应用框架，它遵循MVC（Model-View-Controller）设计模式，但在Django中，这种模式被稍微改变，更常被称为MTV（Model-Template-View）模式。以下是Django框架的基本工作原理：

URL Dispatcher：当一个用户请求到达Django服务器时，Django会首先将这个请求交给URL Dispatcher（URL分发器）。URL Dispatcher会根据请求的URL，在URL配置文件（urls.py）中查找匹配的URL模式。如果找到匹配的模式，它会调用与该模式关联的视图函数。

View：视图函数是处理用户请求的核心部分。视图函数会接收用户的请求，处理请求数据，调用模型和模板，然后返回一个HTTP响应。在处理请求时，视图函数可能需要访问数据库，这时它会调用模型。

Model：模型是代表数据库中的数据的Python对象。模型定义了数据的结构（即数据库的表结构），以及数据的行为（即数据库操作）。视图函数可以通过模型来查询、插入、更新、删除数据。

Template：模板是生成HTML（或其他格式）文档的工具。模板是包含特殊语法的文本文件，可以插入变量、循环、条件等动态元素。视图函数可以将数据传递给模板，然后调用模板的渲染函数，生成动态的HTML文档。

Response：视图函数处理完用户的请求后，会返回一个HTTP响应。这个响应包含了HTTP的状态码（比如200表示成功，404表示未找到等），以及一个或多个HTTP头，以及响应的主体（通常是HTML文档）。这个响应会被发送回用户的浏览器。

## 代码阅读

## 开发规范：
### PEP8
* 缩进：使用4个空格的缩进。
* 行宽：每行的最大长度是79个字符。
* 空行：顶级函数和类的定义之间用两个空行隔开；类的方法之间用一个空行隔开。
* 导入：通常每个import语句只导入一个库模块，不同的import语句应该分为三部分：标准库模块、第三方模块和本地应用/库模块，每部分之间用一个空行隔开。
* 空格：在二元运算符两边添加一个空格，如赋值(=)，比较(==, <, >, !=, <>, <=, >=, in, not in, is, is not)，布尔(and, or, not)。
* 命名规则：模块名应全部小写，可以包含下划线；类名应使用驼峰命名法；函数名应全部小写，可以包含下划线；常量名应全部大写，可以包含下划线。
* 注释：注释应该是完整的句子。如果注释是一个短语或句子，其首字母应该大写，除非它是以代码开始的。
* 文档字符串：所有的公共模块、函数、类和方法都应该有文档字符串。文档字符串应该包含函数的简短描述，以及所有参数和返回值的描述。
https://pep8.org/
### Git使用规范
* 明确的提交信息：每次提交都应该有一个清晰、明确的提交信息，描述这次提交做了什么。这样，其他人在查看提交历史时，可以快速理解每次提交的内容。
* 小步提交：尽量把工作分解为一系列小的、独立的部分，每完成一部分就进行一次提交。这样，如果后面出了问题，可以更容易地找出问题的来源。
* 避免提交临时文件和编译产生的文件：这些文件不应该包含在版本控制中。你可以使用.gitignore文件来指定Git应该忽略的文件和目录。
* 使用分支：对于每个新功能或者bug修复，都应该创建一个新的分支进行开发。完成后，再将这个分支合并回主分支。这样可以保持主分支的稳定，也方便并行开发。
* 定期拉取和推送：定期从远程仓库拉取最新的改动，并推送你的改动到远程仓库，以保持同步。
* 代码审查：在合并分支之前，应该进行代码审查。这可以帮助发现潜在的问题，提高代码质量。
* 避免重写公共历史：不要使用git push --force等命令重写公共历史。如果你需要修正一个已经推送的提交，可以创建一个新的提交来修正。
* 使用tag来标记重要的点：例如，你可以使用tag来标记版本号。
### 测试规范等
## 实践操作
添加一个新的视图函数、修改一个模型定义、写一个单元测试等。
## 代码审查
我会对代码进行审查，给出建设性的反馈，以帮助改进编程技巧。
同时，也会让其他人参与到代码审查中，这是一个很好的学习和进步的机会。
## QA
提问并寻求帮助是学习的一部分，没有什么问题是“愚蠢的”。